<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Razer Phone 2 â€” Mobile NixOS</title>
<link rel="stylesheet" href="../styles/styles.css">
<link lang="en" rel="alternate" type="application/rss+xml" title="RSS feed (EN)" href="../index.xml" />
</head>
<body class="devices_razer-cheryl2 article">
<header>
  <nav>
    <ul>
      <li>
        <h1>
          <a href='../index.html' class=''>Mobile NixOS</a>
        </h1>
      </li>
      <li><a href='../getting-started.html' class=''>Getting Started</a></li>
      <li><a href='../resources.html' class=''>Resources</a></li>
      <li><a href='../devices/index.html' class=''>Devices List</a></li>
    </ul>
  </nav>
</header>

<div id="header">
<h1>Razer Phone 2</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="sidebarblock device-sidebar">
<div class="content">
<div class="title">Razer Phone 2</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Manufacturer</dt>
<dd>
<p>Razer</p>
</dd>
<dt class="hdlist1">Name</dt>
<dd>
<p>Phone 2</p>
</dd>
<dt class="hdlist1">Identifier</dt>
<dd>
<p>razer-cheryl2</p>
</dd>
<dt class="hdlist1">System Type</dt>
<dd>
<p>android</p>
</dd>
<dt class="hdlist1">SoC</dt>
<dd>
<p>qualcomm-sdm845</p>
</dd>
<dt class="hdlist1">Architecture</dt>
<dd>
<p>aarch64-linux</p>
</dd>
<dt class="hdlist1">Supports Stage-0</dt>
<dd>
<p>no</p>
</dd>
<dt class="hdlist1">Source</dt>
<dd>
<p><a href="https://github.com/NixOS/mobile-nixos/tree/master/devices/razer-cheryl2">Mobile NixOS repository</a></p>
</dd>
<dt class="hdlist1">Builds</dt>
<dd>
<p><a href="https://hydra.nixos.org/job/mobile-nixos/unstable/device.razer-cheryl2.x86_64-linux">Hydra (<code>default</code> build)</a></p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_and_installing">Building and installing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are multiple installation methods for your <em>Razer Phone 2</em>.
They all rely on flashing one or more partitions on your device.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p><strong>All installation methods can lead to data loss.</strong></p>
</div>
<div class="paragraph">
<p>Flashing a partition <strong>will erase everything on the partition</strong>. Additionally,
the common backups methods, e.g. TWRP, will <strong>not</strong> backup the <code>userdata</code>
partition, which may be the installation target.</p>
</div>
<div class="paragraph">
<p>Make backups.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_using_fastboot">Using Fastboot</h3>
<div class="paragraph">
<p>This will produce a folder with a flashing script, and the partition images for
your <em>Razer Phone 2</em>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ nix-build --argstr device razer-cheryl2 -A build.android-fastboot-images</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can build a specific partition image:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ nix-build --argstr device razer-cheryl2 -A build.android-bootimg
$ nix-build --argstr device razer-cheryl2 -A build.rootfs</pre>
</div>
</div>
<div class="paragraph">
<p>The device will need to be booted in its bootloader, or <code>fastboot</code>, mode.</p>
</div>
<div class="paragraph">
<p>The boot images can be installed using the following command, assuming the
<code>android-fastboot-images</code> output was used.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ result/flash-critical.sh</pre>
</div>
</div>
<div class="paragraph">
<p>If you have a system image (<code>system.img</code>) built, you can use <code>fastboot</code> to
flash it to the device. Note that it might be too big to fit over the <code>system</code>
partition. In such case, it can be flashed on the <code>userdata</code> partition.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ fastboot flash userdata system.img</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_a_flashable_zip">Using a flashable zip</h3>
<div class="paragraph">
<p>An alternative installation method is to use a flashable zip. The flashable zip
can be built for your <em>Razer Phone 2</em> using one of the following
commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ nix-build --argstr device razer-cheryl2 -A build.android-flashable-bootimg
$ nix-build --argstr device razer-cheryl2 -A build.android-flashable-system
$ nix-build --argstr device razer-cheryl2 -A build.android-flashable-zip</pre>
</div>
</div>
<div class="paragraph">
<p>The first two will flash only a specific partition. The last one contains the
partitions of the two previous one.</p>
</div>
<div class="paragraph">
<p>The zip can either be copied to the device and selected in a compatible
Android recovery, or sent to the device through <code>adb sideload</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ adb sideload /nix/store/eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee-flashable-razer-cheryl2-boot.zip</pre>
</div>
</div>
<div class="paragraph">
<p>By default it will flash to the <code>system</code> partition. Some configurations may
change this to flash to the <code>userdata</code> partition. In that case, <strong>no warning is
given before flashing</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_device_specific_notes">Device-specific notes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_display_problems">Display problems</h3>
<div class="paragraph">
<p>The video drivers from the vendor do not support being used with the classic
framebuffer.</p>
</div>
<div class="paragraph">
<p>Only DRM (Direct Rendering Manager) is supported.</p>
</div>
<div class="paragraph">
<p>A workaround, for the time being, is to use <code>simplefb</code>. Though when the device
boots in the default system, the <code>simplefb</code> framebuffer stops working. It is
suspected that it is the video drivers switching the display to HDR that are
causing this issue.</p>
</div>
<div class="paragraph">
<p>A workaround to help with this workaround has been implemented. When booted in
the default system, the early init will reboot to recovery. In recovery mode
the kernel does not exhibit this issue.</p>
</div>
<div class="paragraph">
<p>The solution to this problem will be to properly support DRM-only workflows.</p>
</div>
<div class="paragraph">
<p>Another avenue for solving this is to fix the fbdev emulation driver for the
Qualcomm vendor tree.</p>
</div>
<div class="paragraph">
<p>Yet another is to explore using mainline. Though it is unknown if the
dual-DSI display, for which the vendor driver is unique, would work well with
the generic code working with other SDM845 devices.</p>
</div>
</div>
<div class="sect2">
<h3 id="_playing_with_the_rgb_logo">Playing with the RGB logo</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ cd /sys/class/leds
$ for f in *channel*/brightness *channel*/led_current; do echo 25 &gt; $f; done</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<link rel="stylesheet" href="../styles/rouge-github.css">
<footer id="footer">
  <nav>
    <ul>
      <li></li>
      
      
      <li><a href='../sitemap.html' class=''>Site Map</a></li>
    </ul>
  </nav>
</footer>

</body>
</html>